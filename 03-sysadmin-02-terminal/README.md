# ДЗ 3-2

1. Какого типа команда cd? Попробуйте объяснить, почему она именно такого типа; опишите ход своих мыслей, если считаете что она могла бы быть другого типа.

```
vagrant@vagrant:~$ type cd
cd is a shell builtin

vagrant@vagrant:~$ strace cd ~
strace: Can't stat 'cd': No such file or directory
```

```
Ответ: cd  - Встроенная функция bash и не является файлом. Т.О. команда связана с инстансом терминала. Вожможно это связано с удобством реализации и безопастностью. 
```
3. Какая альтернатива без pipe команде `grep <some_string> <some_file> | wc -l`? `man grep` поможет в ответе на этот вопрос. Ознакомьтесь с [документом](http://www.smallo.ruhr.de/award.html) о других подобных некорректных вариантах использования pipe.
```
vagrant@vagrant:~$ cat test32.txt
один
четыре
два
четыре 
три
четыре 
пять
vagrant@vagrant:~$ grep четыре test32.txt | wc -l
3
vagrant@vagrant:~$ grep -c четыре test32.txt 
3
vagrant@vagrant:~$

```
```Ответ: grep -c```

4. Какой процесс с PID `1` является родителем для всех процессов в вашей виртуальной машине Ubuntu 20.04?
```
vagrant@vagrant:~$ pstree -p
systemd(1)─┬─VBoxService(787)─┬─{VBoxService}(789)
           │                  ├─{VBoxService}(790)
           │                  ├─{VBoxService}(791)


```

```Ответ: systemd```
5. Как будет выглядеть команда, которая перенаправит вывод stderr `ls` на другую сессию терминала?
```
vagrant@vagrant:~$ who
vagrant  pts/1        2021-11-20 10:05 (10.0.2.2)
vagrant  pts/2        2021-11-20 10:58 (10.0.2.2)
vagrant@vagrant:~$ ls -l test 2>/dev/pts/2

vagrant@vagrant:~$ ls: cannot access 'test': No such file or directory
```
6. Получится ли одновременно передать команде файл на stdin и вывести ее stdout в другой файл? Приведите работающий пример.

```Ответ: да```
```
cat < from.txt > to.txt
```
7. Получится ли находясь в графическом режиме, вывести данные из PTY в какой-либо из эмуляторов TTY? Сможете ли вы наблюдать выводимые данные?

```Ответ:```
```
nariman@nariman:~$ echo Hello > /dev/tty1
bash: /dev/tty1: Отказано в доступе
nariman@nariman:~$ echo Hello | sudo tee /dev/tty1
[sudo] пароль для nariman: 
Hello

Можно наблюдать переключившись на соответвующий tty1 в ctrl+alt+F1
```
8. Выполните команду `bash 5>&1`. К чему она приведет? Что будет, если вы выполните `echo netology > /proc/$$/fd/5`? Почему так происходит?
```
Ответ:
bash 5>&1 - Создаст дескриптор с 5 и перенатправит его в stdout
echo netology > /proc/$$/fd/5 - выведет 'netology' в дескриптор "5", который тперь указывает на stdout

vagrant@vagrant:~$ bash 5>&1
vagrant@vagrant:~$ echo netology > /proc/$$/fd/5
netology
```
9. Получится ли в качестве входного потока для pipe использовать только stderr команды, не потеряв при этом отображение stdout на pty? Напоминаем: по умолчанию через pipe передается только stdout команды слева от `|` на stdin команды справа.
Это можно сделать, поменяв стандартные потоки местами через промежуточный новый дескриптор, который вы научились создавать в предыдущем вопросе.
```
Ответ:
vagrant@vagrant:~$ ls -l /root 9>&2 2>&1 1>&9 |grep denied -c 
1

9>&2 - новый дескриптор перенаправили в stderr
2>&1 - stderr перенаправили в stdout 
1>&9 - stdout - перенаправили в в новый дескриптор

```
10. Что выведет команда `cat /proc/$$/environ`? Как еще можно получить аналогичный по содержанию вывод?
```
Будут выведены переменные окружения. Так же можно вывести командой env

```
11. Используя `man`, опишите что доступно по адресам `/proc/<PID>/cmdline`, `/proc/<PID>/exe`.
```
Ответ:
/proc/<PID>/cmdline - полный путь до исполняемого файла процесса [PID]  (строка 231)
/proc/<PID>/exe - содержит ссылку до файла запущенного для процесса [PID] (строка 285)
```
12. Узнайте, какую наиболее старшую версию набора инструкций SSE поддерживает ваш процессор с помощью `/proc/cpuinfo`.
```
vagrant@vagrant:~$ grep sse /proc/cpuinfo
Ответ: sse4_2
```
13. При открытии нового окна терминала и `vagrant ssh` создается новая сессия и выделяется pty. Это можно подтвердить командой `tty`, которая упоминалась в лекции 3.2. Однако:

     ```bash
     vagrant@netology1:~$ ssh localhost 'tty'
     not a tty
     ```

     Почитайте, почему так происходит, и как изменить поведение.

```Ответ: При подключении по ssh, TTY находится не на удалённой машине. Чтобы изменить поведение нужно использовать флаг -t```
14. Бывает, что есть необходимость переместить запущенный процесс из одной сессии в другую. Попробуйте сделать это, воспользовавшись `reptyr`. Например, так можно перенести в `screen` процесс, который вы запустили по ошибке в обычной SSH-сессии.
```


nariman@nariman:~$ ping 8.8.8.8
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=59 time=62.9 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=59 time=56.3 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=59 time=59.8 ms
^Z
[1]+  Остановлено  ping 8.8.8.8
nariman@nariman:~$ ps -a
  PID TTY          TIME CMD
 5308 pts/20   00:00:00 bash
 5309 pts/20   00:00:00 vagrant
 5314 pts/20   00:00:00 ssh
13363 pts/19   00:00:00 ping
13832 pts/19   00:00:00 ps
19991 pts/11   00:00:00 bash
19992 pts/11   00:00:00 vagrant
19997 pts/11   00:00:00 ssh


nariman@nariman:~$ sudo reptyr -T 13363


nariman@nariman:~$ 64 bytes from 8.8.8.8: icmp_seq=9 ttl=59 time=59.0 ms
64 bytes from 8.8.8.8: icmp_seq=10 ttl=59 time=55.1 ms
64 bytes from 8.8.8.8: icmp_seq=11 ttl=59 time=58.7 ms
64 bytes from 8.8.8.8: icmp_seq=12 ttl=59 time=58.8 ms

```
15. `sudo echo string > /root/new_file` не даст выполнить перенаправление под обычным пользователем, так как перенаправлением занимается процесс shell'а, который запущен без `sudo` под вашим пользователем. Для решения данной проблемы можно использовать конструкцию `echo string | sudo tee /root/new_file`. Узнайте что делает команда `tee` и почему в отличие от `sudo echo` команда с `sudo tee` будет работать.
```
Ответ: tee используется для разделения выводимых программой данных,таким образом данные могут быть использованы для вывода на дисплей и сохранены в файл.
В данном случае используется не поток а строковый результат выполнения команды а так же сама команда tee запущена из под sudo.```